struct Smol {
    a : char;
    b : char;
}

proc pass_smol(s : Smol) => int {
    return s.a + s.b;
}

struct Vec3 {
    x : char;
    y : char;
    z : char;
}

proc vec3_add_comps(a: Vec3, b:  Vec3) => int {
    return a.x + a.y + a.z + b.x + b.y + b.z;
}

struct Buf {
    buf : [1024] char;
}

struct BarResult {
    r : int;
    buf: [32] char;
}

proc bar(a : int, b : Buf, c : Buf, d : int) => BarResult {
    var r : BarResult;

    r.r = a + b.buf[0] + c.buf[256] + d;
    r.buf[31] = 2;

    return r;
}

proc vec3_add(a : Vec3, b : Vec3) => Vec3 {
    var c : Vec3;

    c.x = a.x + b.x;
    c.y = a.y + b.y;
    c.z = a.z + b.z;

    return c;
}

proc main() => int {
    #writeout("Structs\n", 8);

    var s : Smol;
    s.a = 1;
    s.b = 10;

    var r := pass_smol(s);

    var v1 : Vec3;
    var v2 : Vec3;
    v1.x = 1; v1.y = 2; v1.z = 3;
    v2 = v1;

    var r2 := vec3_add_comps(v1, v2);

    var buf : Buf;
    buf.buf[0] = 20;

    var buf2: Buf;
    buf2.buf[256] = 10;

    var r3 : BarResult = bar(3, buf, buf2, 4);

    var r4 := vec3_add(v1, v2);

    return r + r2 + r3.r + r3.buf[31] + r4.x + r4.y + r4.z; // 11 + 12 + 37 + 2 + (2 + 4 + 6) = 74
}
